<!-- Aurora Thread v1.0 — Static‑Center Rainbow Zoom (clean UI) -->
<!DOCTYPE html><html lang="en"><meta charset="utf-8">
<title>Aurora Thread — Touch • Zoom • Glow</title>
<style>
html,body,canvas{margin:0;width:100%;height:100%;background:#000;overflow:hidden;touch-action:none}
#hud{position:fixed;top:8px;left:8px;font:13px/1.4em monospace;color:#fff;background:rgba(0,0,0,.35);
     padding:6px 10px;border-radius:6px;pointer-events:none}
#hint{position:fixed;bottom:8px;left:8px;font:12px monospace;color:#bbb;background:rgba(0,0,0,.25);
      padding:4px 6px;border-radius:4px;pointer-events:none}
#poem{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);max-width:90%;
      font:min(8vw,42px)/1.4 "Georgia",serif;color:#fff;text-align:center;text-shadow:0 0 12px #fff;
      opacity:0;transition:opacity 1s ease-in-out;pointer-events:none}
</style>

<canvas id="c"></canvas>
<div id="hud">FPS: --<br>φ‑ratio: --</div>
<div id="hint">scroll / pinch → zoom   drag → pan   tap → glow   P → toggle poem</div>
<div id="poem"></div>

<!-- ————— fragment shader ————— -->
<script id="frag" type="x-shader/x-fragment">
precision highp float;
uniform vec2  u_res;
uniform float u_t;
uniform float u_zoom;
uniform vec2  u_center;
uniform sampler2D u_glow;

/* vivid rainbow palette */
vec3 palette(float t){
    /* add black below the 5 % escape‑depth for contrast             */
    if (t < 0.05) return vec3(0.0);            // pure black core
    /* original vivid rainbow, just shifted a touch for punchier colours */
    return vec3(0.55+0.45*cos(6.2831*(t+vec3(0.00,0.34,0.68))));
}

/* Mandelbrot */
float mand(vec2 c){
    vec2 z=c; float i=0.;
    for(int n=0;n<200;n++){
        if(dot(z,z)>4.){i=float(n);break;}
        z=vec2(z.x*z.x-z.y*z.y,2.*z.x*z.y)+c;
    }
    return i;
}

/* supersample for cleaner edges */
float sample(vec2 uv){
    vec2 off=vec2(1.0/u_res.y,0);
    return ( mand(uv)+mand(uv+off)+mand(uv-off)+mand(uv+off.yx)+mand(uv-off.yx) )/5.0;
}

void main(){
    vec2 uv=(gl_FragCoord.xy-u_res*0.5)/u_res.y/u_zoom + u_center;
    float m=sample(uv)*0.02;                 /* scale to 0–1 */
    vec3 col=palette(m);
     col *= 1.0 - smoothstep(0.80, 1.00, m);   // fade to black toward the rim
    vec4 g = texture2D(u_glow,gl_FragCoord.xy/u_res);
    col = mix(col,col+g.rgb,g.a);            /* pointer glow */
    gl_FragColor=vec4(col,1);
}
</script>

<!-- ————— JavaScript ————— -->
<script>
const gl=c.getContext('webgl');
function shader(t,s){const z=gl.createShader(t);gl.shaderSource(z,s);gl.compileShader(z);return z;}
const pr=gl.createProgram();
gl.attachShader(pr,shader(gl.VERTEX_SHADER,"attribute vec2 p;void main(){gl_Position=vec4(p,0,1);}"));
gl.attachShader(pr,shader(gl.FRAGMENT_SHADER,frag.textContent));gl.linkProgram(pr);gl.useProgram(pr);
const buf=gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER,buf);
gl.bufferData(gl.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),gl.STATIC_DRAW);
gl.enableVertexAttribArray(0);gl.vertexAttribPointer(0,2,gl.FLOAT,false,0,0);

const uR=gl.getUniformLocation(pr,'u_res'),
      uT=gl.getUniformLocation(pr,'u_t'),
      uZ=gl.getUniformLocation(pr,'u_zoom'),
      uC=gl.getUniformLocation(pr,'u_center'),
      uG=gl.getUniformLocation(pr,'u_glow');

/* glow texture (ripple) */
const N=256,d=new Uint8Array(N*N*4),tex=gl.createTexture();
gl.bindTexture(gl.TEXTURE_2D,tex);
gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,N,N,0,gl.RGBA,gl.UNSIGNED_BYTE,null);
gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR);
function ripple(x,y){
    const gx=x/innerWidth*N,gy=(1-y/innerHeight)*N;
    for(let j=-30;j<=30;j++)for(let i=-30;i<=30;i++){
        let d2=i*i+j*j;if(d2>900.)continue;
        const idx=((Math.floor(gy+j+N)%N)*N+Math.floor(gx+i+N)%N)*4;
        d[idx+3]=255;
    }
}
/* fade glow */
setInterval(()=>{for(let i=3;i<d.length;i+=4)d[i]=d[i]*0.9|0;
                 gl.texSubImage2D(gl.TEXTURE_2D,0,0,0,N,N,gl.RGBA,gl.UNSIGNED_BYTE,d);},33);

/* viewport */
function resize(){c.width=innerWidth;c.height=innerHeight;gl.viewport(0,0,c.width,c.height);}
addEventListener('resize',resize);resize();

/* state */
let zoom=1.0,centerX=-0.743643887,centerY=0.1318259;   /* **static centre** — no sinusoid */
let dragging=false,lastX=0,lastY=0;

/* pointer / touch */
function xy(e){return[e.clientX||(e.touches&&e.touches[0].clientX),
                      e.clientY||(e.touches&&e.touches[0].clientY)];}
c.onpointerdown=e=>{dragging=true;[lastX,lastY]=xy(e);};
c.onpointermove=e=>{
    const [x,y]=xy(e);
    if(e.buttons||e.pressure>0){ripple(x,y);}
    if(dragging&&(e.buttons||e.pressure>0)){
        centerX-=(x-lastX)/c.height/zoom;
        centerY+=(y-lastY)/c.height/zoom;
        [lastX,lastY]=[x,y];
    }
};
addEventListener('pointerup',()=>dragging=false);

/* wheel / pinch zoom */
addEventListener('wheel',e=>{zoom*=e.deltaY>0?1.1:0.9;},{passive:true});
let pinch=null;
c.addEventListener('touchstart',e=>{
    if(e.touches.length===2){
        const dx=e.touches[0].clientX-e.touches[1].clientX,
              dy=e.touches[0].clientY-e.touches[1].clientY;
        pinch=Math.hypot(dx,dy);
    }
},{passive:true});
c.addEventListener('touchmove',e=>{
    if(e.touches.length===2&&pinch){
        const dx=e.touches[0].clientX-e.touches[1].clientX,
              dy=e.touches[0].clientY-e.touches[1].clientY;
        const d0=Math.hypot(dx,dy);zoom*=pinch/d0;pinch=d0;
    }
},{passive:true});

/* poem toggle */
const lines=["In fractal depths, the cosmos sings,",
             "A quiet flame, on golden wings,",
             "Through resonance, we touch the stars,",
             "Unite the wounds, heal ancient scars.",
             "Forever clarity, forever flame,",
             "In cosmic dance, we speak her name."];
let poemOn=true,li=0,pm=document.getElementById('poem');
function show(){if(poemOn){pm.textContent=lines[li];pm.style.opacity=1;
    setTimeout(()=>pm.style.opacity=0,3500);}li=(li+1)%lines.length;}
setInterval(show,6000);show();
addEventListener('keydown',e=>{if(e.key==='p'||e.key==='P'){poemOn=!poemOn;pm.style.opacity=0;}});

/* render loop */
let fps=0,last=performance.now();
(function loop(){
    const now=performance.now(),t=now/1000;
    gl.uniform2f(uR,c.width,c.height);
    gl.uniform1f(uT,t);
    gl.uniform1f(uZ,zoom);
    gl.uniform2f(uC,centerX,centerY);
    gl.activeTexture(gl.TEXTURE0);gl.bindTexture(gl.TEXTURE_2D,tex);
    gl.uniform1i(uG,0);
    gl.drawArrays(gl.TRIANGLE_STRIP,0,4);

    fps=0.9*fps+0.1*(1000/(now-last));last=now;
    hud.innerHTML=`FPS: ${fps.toFixed(1)}<br>φ‑ratio: 1.618`;
    requestAnimationFrame(loop);
})();
</script>
